"use strict";(self.webpackChunkstudio_prismic_starter=self.webpackChunkstudio_prismic_starter||[]).push([[24],{3173:function(e,t,s){s.d(t,{l:function(){return a}});const a=(e,t)=>`gatsby-plugin-prismic-previews(${e}) - ${t}`},2381:function(e,t,s){s.d(t,{s:function(){return L}});const a=e=>Array.isArray(e)?e:[e],n=(e={},t)=>({...e,filters:[...e.filters||[],...a(t)]});var i=s(978);const r=e=>i.h.at("document.tags",a(e));var o=s(2194);const c=(e,t)=>{const s=e.find((e=>t(e)));if(!s)throw new o.b("Ref could not be found.",void 0,void 0);return s},h=e=>c(e,(e=>e.isMasterRef)),l=(e,t)=>c(e,(e=>e.id===t)),u=(e,t)=>c(e,(e=>e.label===t)),f=e=>e.replace(/%3B/g,";"),d=e=>i.h.any("document.tags",a(e)),g=e=>i.h.at("document.type",e);class y extends o.b{}class p extends o.b{}class m extends o.b{}var w=s(610);const R={accessToken:"access_token"},b=e=>"string"==typeof e?e:"desc"===e.direction?`${e.field} desc`:e.field;var v=s(5744);var k=Object.defineProperty,S=(e,t,s)=>(((e,t,s)=>{t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);var T,A;(A=T||(T={})).Master="Master",A.ReleaseID="ReleaseID",A.ReleaseLabel="ReleaseLabel",A.Manual="Manual";class P{constructor(e,t={}){if(S(this,"endpoint"),S(this,"accessToken"),S(this,"routes"),S(this,"brokenRoute"),S(this,"fetchFn"),S(this,"fetchOptions"),S(this,"defaultParams"),S(this,"refState",{mode:T.Master,autoPreviewsEnabled:!0}),S(this,"cachedRepository"),S(this,"cachedRepositoryExpiration",0),S(this,"fetchJobs",{}),(e=>{try{return new URL(e),!0}catch{return!1}})(e)?this.endpoint=e:this.endpoint=(e=>{if((0,v.Z)(e))return`https://${e}.cdn.prismic.io/api/v2`;throw new o.b(`An invalid Prismic repository name was given: ${e}`,void 0,void 0)})(e),this.accessToken=t.accessToken,this.routes=t.routes,this.brokenRoute=t.brokenRoute,this.fetchOptions=t.fetchOptions,this.defaultParams=t.defaultParams,t.ref&&this.queryContentFromRef(t.ref),"function"==typeof t.fetch)this.fetchFn=t.fetch;else{if("function"!=typeof globalThis.fetch)throw new o.b("A valid fetch implementation was not provided. In environments where fetch is not available (including Node.js), a fetch implementation must be provided via a polyfill or the `fetch` option.",void 0,void 0);this.fetchFn=globalThis.fetch}this.fetchFn===globalThis.fetch&&(this.fetchFn=this.fetchFn.bind(globalThis)),this.graphQLFetch=this.graphQLFetch.bind(this)}enableAutoPreviews(){this.refState.autoPreviewsEnabled=!0}enableAutoPreviewsFromReq(e){this.refState.httpRequest=e,this.refState.autoPreviewsEnabled=!0}disableAutoPreviews(){this.refState.autoPreviewsEnabled=!1}async get(e){const t=await this.buildQueryURL(e);return await this.fetch(t,e)}async getFirst(e){var t;const s={...e};e&&e.page||(null==e?void 0:e.pageSize)||(s.pageSize=(null==(t=this.defaultParams)?void 0:t.pageSize)??1);const a=await this.buildQueryURL(s),n=(await this.fetch(a,e)).results[0];if(n)return n;throw new o.b("No documents were returned",a,void 0)}async dangerouslyGetAll(e={}){var t;const{limit:s=1/0,...a}=e,n={...a,pageSize:Math.min(s,a.pageSize||(null==(t=this.defaultParams)?void 0:t.pageSize)||100)},i=[];let r;for(;(!r||r.next_page)&&i.length<s;){const e=r?r.page+1:void 0;r=await this.get({...n,page:e}),i.push(...r.results),r.next_page&&await new Promise((e=>setTimeout(e,500)))}return i.slice(0,s)}async getByID(e,t){return await this.getFirst(n(t,i.h.at("document.id",e)))}async getByIDs(e,t){return await this.get(n(t,i.h.in("document.id",e)))}async getAllByIDs(e,t){return await this.dangerouslyGetAll(n(t,i.h.in("document.id",e)))}async getByUID(e,t,s){return await this.getFirst(n(s,[g(e),i.h.at(`my.${e}.uid`,t)]))}async getByUIDs(e,t,s){return await this.get(n(s,[g(e),i.h.in(`my.${e}.uid`,t)]))}async getAllByUIDs(e,t,s){return await this.dangerouslyGetAll(n(s,[g(e),i.h.in(`my.${e}.uid`,t)]))}async getSingle(e,t){return await this.getFirst(n(t,g(e)))}async getByType(e,t){return await this.get(n(t,g(e)))}async getAllByType(e,t){return await this.dangerouslyGetAll(n(t,g(e)))}async getByTag(e,t){return await this.get(n(t,d(e)))}async getAllByTag(e,t){return await this.dangerouslyGetAll(n(t,d(e)))}async getByEveryTag(e,t){return await this.get(n(t,r(e)))}async getAllByEveryTag(e,t){return await this.dangerouslyGetAll(n(t,r(e)))}async getBySomeTags(e,t){return await this.get(n(t,d(e)))}async getAllBySomeTags(e,t){return await this.dangerouslyGetAll(n(t,d(e)))}async getRepository(e){const t=new URL(this.endpoint);return this.accessToken&&t.searchParams.set("access_token",this.accessToken),await this.fetch(t.toString(),e)}async getRefs(e){return(await this.getRepository(e)).refs}async getRefByID(e,t){const s=await this.getRefs(t);return l(s,e)}async getRefByLabel(e,t){const s=await this.getRefs(t);return u(s,e)}async getMasterRef(e){const t=await this.getRefs(e);return h(t)}async getReleases(e){return(await this.getRefs(e)).filter((e=>!e.isMasterRef))}async getReleaseByID(e,t){const s=await this.getReleases(t);return l(s,e)}async getReleaseByLabel(e,t){const s=await this.getReleases(t);return u(s,e)}async getTags(e){try{const t=await this.getCachedRepositoryForm("tags",e),s=new URL(t.action);return this.accessToken&&s.searchParams.set("access_token",this.accessToken),await this.fetch(s.toString(),e)}catch{return(await this.getRepository(e)).tags}}async buildQueryURL({signal:e,fetchOptions:t,...s}={}){const n=s.ref||await this.getResolvedRefString({signal:e,fetchOptions:t}),i=s.integrationFieldsRef||(await this.getCachedRepository({signal:e,fetchOptions:t})).integrationFieldsRef||void 0;return((e,t)=>{const{filters:s,predicates:n,...i}=t,r=new URL("documents/search",`${e}/`);if(s)for(const o of a(s))r.searchParams.append("q",`[${o}]`);if(n)for(const o of a(n))r.searchParams.append("q",`[${o}]`);for(const o in i){const e=R[o]||o;let t=i[o];if("orderings"===e){const s=i[e];null!=s&&(t=`[${a(s).map((e=>b(e))).join(",")}]`)}else"routes"===e&&"object"==typeof i[e]&&(t=JSON.stringify(a(i[e])));null!=t&&r.searchParams.set(e,a(t).join(","))}return r.toString()})(this.endpoint,{...this.defaultParams,...s,ref:n,integrationFieldsRef:i,routes:s.routes||this.routes,brokenRoute:s.brokenRoute||this.brokenRoute,accessToken:s.accessToken||this.accessToken})}async resolvePreviewURL(e){var t,s;let a=e.documentID,n=e.previewToken;if(void 0!==globalThis.location){const e=new URLSearchParams(globalThis.location.search);a=a||e.get("documentId"),n=n||e.get("token")}else if(this.refState.httpRequest)if("query"in this.refState.httpRequest)a=a||(null==(t=this.refState.httpRequest.query)?void 0:t.documentId),n=n||(null==(s=this.refState.httpRequest.query)?void 0:s.token);else if("url"in this.refState.httpRequest&&this.refState.httpRequest.url){const e=new URL(this.refState.httpRequest.url,"missing-host://").searchParams;a=a||e.get("documentId"),n=n||e.get("token")}if(null!=a&&null!=n){const t=await this.getByID(a,{ref:n,lang:"*",signal:e.signal,fetchOptions:e.fetchOptions}),s=(0,w.s)(t,{linkResolver:e.linkResolver});if("string"==typeof s)return s}return e.defaultURL}queryLatestContent(){this.refState.mode=T.Master}queryContentFromReleaseByID(e){this.refState={...this.refState,mode:T.ReleaseID,releaseID:e}}queryContentFromReleaseByLabel(e){this.refState={...this.refState,mode:T.ReleaseLabel,releaseLabel:e}}queryContentFromRef(e){this.refState={...this.refState,mode:T.Manual,ref:e}}async graphQLFetch(e,t){const s=await this.getCachedRepository(),a=await this.getResolvedRefString(),n={"Prismic-ref":a,Authorization:this.accessToken?`Token ${this.accessToken}`:"",...t?t.headers:{}};s.integrationFieldsRef&&(n["Prismic-integration-field-ref"]=s.integrationFieldsRef);const i={};for(const c in n)n[c]&&(i[c.toLowerCase()]=n[c]);const r=new URL(e);r.searchParams.set("ref",a);const o=r.searchParams.get("query");return o&&r.searchParams.set("query",(e=>e.replace(/(\n| )*( |{|})(\n| )*/gm,((e,t,s)=>s)))(o)),await this.fetchFn(r.toString(),{...t,headers:i})}async getCachedRepository(e){return(!this.cachedRepository||Date.now()>=this.cachedRepositoryExpiration)&&(this.cachedRepositoryExpiration=Date.now()+5e3,this.cachedRepository=await this.getRepository(e)),this.cachedRepository}async getCachedRepositoryForm(e,t){const s=(await this.getCachedRepository(t)).forms[e];if(!s)throw new o.b(`Form with name "${e}" could not be found`,void 0,void 0);return s}async getResolvedRefString(e){var t,s;if(this.refState.autoPreviewsEnabled){let e,a;if((null==(t=this.refState.httpRequest)?void 0:t.headers)?"get"in this.refState.httpRequest.headers&&"function"==typeof this.refState.httpRequest.headers.get?a=this.refState.httpRequest.headers.get("cookie"):"cookie"in this.refState.httpRequest.headers&&(a=this.refState.httpRequest.headers.cookie):(null==(s=globalThis.document)?void 0:s.cookie)&&(a=globalThis.document.cookie),a&&(e=(e=>{const t=e.split("; ");let s;for(const a of t){const e=a.split("=");if("io.prismic.preview"===f(e[0]).replace(/%3D/g,"=")){s=f(e.slice(1).join("="));break}}return s})(a)),e)return e}const a=await this.getCachedRepository(e),n=this.refState.mode;if(n===T.ReleaseID)return l(a.refs,this.refState.releaseID).ref;if(n===T.ReleaseLabel)return u(a.refs,this.refState.releaseLabel).ref;if(n===T.Manual){const e=await(i=this.refState.ref,"function"==typeof i?i:()=>i)();if("string"==typeof e)return e}var i;return h(a.refs).ref}async fetch(e,t={}){var s,a,n,i;const r={...this.fetchOptions,...t.fetchOptions,headers:{...null==(s=this.fetchOptions)?void 0:s.headers,...null==(a=t.fetchOptions)?void 0:a.headers},signal:(null==(n=t.fetchOptions)?void 0:n.signal)||t.signal||(null==(i=this.fetchOptions)?void 0:i.signal)};let c;this.fetchJobs[e]&&this.fetchJobs[e].has(r.signal)?c=this.fetchJobs[e].get(r.signal):(this.fetchJobs[e]=this.fetchJobs[e]||new Map,c=this.fetchFn(e,r).then((async e=>{let t;try{t=await e.json()}catch{}return{status:e.status,json:t}})).finally((()=>{this.fetchJobs[e].delete(r.signal),0===this.fetchJobs[e].size&&delete this.fetchJobs[e]})),this.fetchJobs[e].set(r.signal,c));const h=await c;if(404!==h.status&&null==h.json)throw new o.b(void 0,e,h.json);switch(h.status){case 200:return h.json;case 400:throw new m(h.json.message,e,h.json);case 401:case 403:throw new y("error"in h.json?h.json.error:h.json.message,e,h.json);case 404:throw new p(`Prismic repository not found. Check that "${this.endpoint}" is pointing to the correct repository.`,e,void 0)}throw new o.b(void 0,e,h.json)}}var D=s(836);const L=e=>{const t=D.K.getState();if(t.client)return t.client;{const n=(s=e.apiEndpoint||e.repositoryName,a={accessToken:e.accessToken,routes:e.routes,defaultParams:{lang:e.lang||"*",fetchLinks:e.fetchLinks,graphQuery:e.graphQuery,predicates:e.predicates}},new P(s,a));return t.setClient(n),n}var s,a}},91:function(e,t,s){s.d(t,{l:function(){return n}});var a=s(836);const n=e=>a.K.getState().pluginOptions[e]},7604:function(e,t,s){s.d(t,{H:function(){return n}});var a=s(836);const n=e=>a.K.getState().repositoryConfigs.find((t=>t.repositoryName===e))},2194:function(e,t,s){s.d(t,{b:function(){return i}});var a=Object.defineProperty,n=(e,t,s)=>(((e,t,s)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s);class i extends Error{constructor(e="An invalid API response was returned",t,s){super(e),n(this,"url"),n(this,"response"),this.url=t,this.response=s}}},978:function(e,t,s){s.d(t,{h:function(){return r}});const a=e=>Array.isArray(e)?`[${e.map(a).join(", ")}]`:"string"==typeof e?`"${e}"`:e instanceof Date?`${e.getTime()}`:`${e}`,n=e=>(t,...s)=>{const n=s.map(a).join(", "),i=t&&s.length?", ":"";return`[${e}(${t}${i}${n})]`},i=e=>{const t=n(e);return e=>t(e)},r={at:n("at"),not:n("not"),any:n("any"),in:n("in"),fulltext:n("fulltext"),has:i("has"),missing:i("missing"),similar:(e=>{const t=n(e);return(...e)=>t("",...e)})("similar"),geopointNear:n("geopoint.near"),numberLessThan:n("number.lt"),numberGreaterThan:n("number.gt"),numberInRange:n("number.inRange"),dateAfter:n("date.after"),dateBefore:n("date.before"),dateBetween:n("date.between"),dateDayOfMonth:n("date.day-of-month"),dateDayOfMonthAfter:n("date.day-of-month-after"),dateDayOfMonthBefore:n("date.day-of-month-before"),dateDayOfWeek:n("date.day-of-week"),dateDayOfWeekAfter:n("date.day-of-week-after"),dateDayOfWeekBefore:n("date.day-of-week-before"),dateMonth:n("date.month"),dateMonthAfter:n("date.month-after"),dateMonthBefore:n("date.month-before"),dateYear:n("date.year"),dateHour:n("date.hour"),dateHourAfter:n("date.hour-after"),dateHourBefore:n("date.hour-before")}},610:function(e,t,s){s.d(t,{s:function(){return n}});var a=s(361);const n=(e,...t)=>{if(!e)return null;const s="link_type"in e?e:(n=e,{link_type:a.U.Document,id:n.id,uid:n.uid||void 0,type:n.type,tags:n.tags,lang:n.lang,url:null==n.url?void 0:n.url,slug:null==(i=n.slugs)?void 0:i[0],...n.data&&Object.keys(n.data).length>0?{data:n.data}:{}});var n,i;const[r]=t;let o;switch(o="function"==typeof r||null==r?{linkResolver:r}:{...r},s.link_type){case a.U.Media:case a.U.Web:return"url"in s?s.url:null;case a.U.Document:if("id"in s&&o.linkResolver){const e=o.linkResolver(s);if(null!=e)return e}return"url"in s&&s.url?s.url:null;case a.U.Any:default:return null}}},5744:function(e,t,s){s.d(t,{Z:function(){return a}});const a=e=>/^[a-zA-Z0-9][-a-zA-Z0-9]{2,}[a-zA-Z0-9]$/.test(e)},361:function(e,t,s){s.d(t,{U:function(){return a}});const a={Any:"Any",Document:"Document",Media:"Media",Web:"Web"}}}]);
//# sourceMappingURL=f54b42984bfe4d114461fcea2710af414ac1fe74-58d0807318dbe32b764b.js.map